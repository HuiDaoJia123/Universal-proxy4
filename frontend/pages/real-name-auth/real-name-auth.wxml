<view class="auth-container">
  <!-- 顶部导航 -->
  <view class="auth-header">
    <view class="nav-back" bindtap="navigateBack">
      <image class="back-icon" src="/assets/icons/back-arrow.png"></image>
    </view>
    <text class="header-title">学生认证</text>
    <view class="nav-placeholder"></view>
  </view>

  <!-- 认证状态 -->
  <view class="status-card {{authStatus}}">
    <view class="status-icon">
      <image class="status-img" src="{{statusConfig.icon}}"></image>
    </view>
    <view class="status-content">
      <text class="status-title">{{statusConfig.title}}</text>
      <text class="status-desc">{{statusConfig.desc}}</text>
    </view>
    <view class="status-badge">{{statusConfig.badge}}</view>
  </view>

  <!-- 认证表单 -->
  <view class="auth-form" wx:if="{{authStatus === 'not_started' || authStatus === 'failed'}}">
    <!-- 个人信息 -->
    <view class="form-section">
      <view class="section-title">个人信息</view>
      
      <view class="form-item">
        <text class="item-label">真实姓名</text>
        <input 
          class="item-input" 
          type="text" 
          placeholder="请输入您的真实姓名"
          value="{{formData.realName}}"
          bindinput="onRealNameInput"
          maxlength="20"
        />
      </view>
      
      <view class="form-item">
        <text class="item-label">学校名称</text>
        <input 
          class="item-input" 
          type="text" 
          placeholder="请输入您的学校名称"
          value="{{formData.schoolName}}"
          bindinput="onSchoolNameInput"
          maxlength="50"
        />
      </view>
      
      <view class="form-item">
        <text class="item-label">学号</text>
        <input 
          class="item-input" 
          type="text" 
          placeholder="请输入您的学号"
          value="{{formData.studentId}}"
          bindinput="onStudentIdInput"
          maxlength="20"
        />
      </view>
    </view>

    <!-- 证件上传 -->
    <view class="form-section">
      <view class="section-title">学生证上传</view>
      <text class="section-desc">请上传清晰的学生证照片，需包含姓名、学号和学校信息</text>
      
      <view class="upload-single">
        <view 
          class="upload-box {{formData.studentCardImage ? 'has-image' : ''}}"
          bindtap="chooseStudentCardImage"
        >
          <image 
            wx:if="{{formData.studentCardImage}}" 
            class="uploaded-image" 
            src="{{formData.studentCardImage}}" 
            mode="aspectFill"
          ></image>
          <view class="upload-placeholder" wx:else>
            <image class="upload-icon" src="/assets/icons/camera.png"></image>
            <text class="upload-text">上传学生证</text>
            <text class="upload-hint">点击上传学生证照片</text>
          </view>
        </view>
      </view>
      
      <view class="upload-tips">
        <text class="tip-title">上传要求：</text>
        <text class="tip-item">• 照片清晰可辨认</text>
        <text class="tip-item">• 包含姓名、学号、学校信息</text>
        <text class="tip-item">• 照片大小不超过5MB</text>
        <text class="tip-item">• 支持JPG、PNG格式</text>
      </view>
    </view>

    <!-- 认证协议 -->
    <view class="agreement-section">
      <view class="agreement-item" bindtap="toggleAgreement">
        <view class="checkbox {{agreementChecked ? 'checked' : ''}}">
          <image 
            class="check-icon" 
            src="{{agreementChecked ? '/assets/icons/checkbox-checked.png' : '/assets/icons/checkbox-unchecked.png'}}"
          ></image>
        </view>
        <text class="agreement-text">我已阅读并同意</text>
        <text class="agreement-link" bindtap="viewAgreement">《学生认证服务协议》</text>
      </view>
    </view>

    <!-- 提交按钮 -->
    <view class="submit-section">
      <button 
        class="submit-btn {{canSubmit ? 'active' : ''}}" 
        bindtap="submitAuth"
        disabled="{{!canSubmit || isSubmitting}}"
      >
        {{isSubmitting ? '提交中...' : '提交认证'}}
      </button>
    </view>
  </view>

  <!-- 认证成功信息 -->
  <view class="success-info" wx:if="{{authStatus === 'success'}}">
    <view class="info-card">
      <view class="info-header">
        <text class="info-title">认证信息</text>
        <text class="info-time">认证时间: {{authInfo.authTime}}</text>
      </view>
      
      <view class="info-content">
        <view class="info-item">
          <text class="info-label">真实姓名</text>
          <text class="info-value">{{authInfo.realName}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">学校名称</text>
          <text class="info-value">{{authInfo.schoolName}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">学号</text>
          <text class="info-value">{{authInfo.studentId}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">认证状态</text>
          <view class="status-tag success">已认证</view>
        </view>
      </view>
    </view>
    
    <view class="action-buttons">
      <button class="action-btn secondary" bindtap="viewAgreement">查看协议</button>
      <button class="action-btn primary" bindtap="contactService">联系客服</button>
    </view>
  </view>

  <!-- 认证失败信息 -->
  <view class="failed-info" wx:if="{{authStatus === 'failed'}}">
    <view class="info-card">
      <view class="info-header">
        <text class="info-title">认证失败</text>
      </view>
      
      <view class="failed-reason">
        <text class="reason-title">失败原因:</text>
        <text class="reason-desc">{{authInfo.failReason}}</text>
      </view>
      
      <view class="suggestions">
        <text class="suggest-title">建议:</text>
        <view class="suggest-list">
          <text class="suggest-item">• 请确保姓名与学生证信息一致</text>
          <text class="suggest-item">• 请上传清晰、完整的学生证照片</text>
          <text class="suggest-item">• 确保学生证在有效期内</text>
          <text class="suggest-item">• 如问题持续，请联系客服</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 认证审核中 -->
  <view class="reviewing-info" wx:if="{{authStatus === 'reviewing'}}">
    <view class="info-card">
      <view class="reviewing-content">
        <image class="reviewing-icon" src="/assets/icons/reviewing.png"></image>
        <text class="reviewing-title">认证审核中</text>
        <text class="reviewing-desc">我们将在1-3个工作日内完成审核</text>
        <text class="reviewing-time">提交时间: {{authInfo.submitTime}}</text>
      </view>
    </view>
    
    <view class="contact-tip">
      <text class="tip-text">如有疑问，请</text>
      <text class="tip-link" bindtap="contactService">联系客服</text>
    </view>
  </view>

  <!-- 协议弹窗 -->
  <view class="agreement-modal {{showAgreementModal ? 'show' : ''}}">
    <view class="modal-mask" bindtap="hideAgreementModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">学生认证服务协议</text>
        <view class="modal-close" bindtap="hideAgreementModal">
          <image class="close-icon" src="/assets/icons/close.png"></image>
        </view>
      </view>
      
      <scroll-view class="modal-body" scroll-y>
        <text class="agreement-content">
          学生认证服务协议
          一、服务条款
          1.1 本协议是用户（以下简称“您”）与本平台（以下简称“我们”）之间关于学生认证服务的法律协议。
          1.2 您通过点击“提交认证”按钮，即表示您同意接受本协议的全部条款和条件。
          
          二、认证内容
          2.1 您同意提供真实、准确、完整的个人信息（包括但不限于真实姓名、学校名称、学号、学生证照片等）。
          2.2 您保证所提供的信息不会侵犯任何第三方的合法权益。
          
          三、认证审核
          3.1 我们将在收到您的认证申请后1-3个工作日内完成审核。
          3.2 审核结果将通过平台通知或短信方式告知您。
          
          四、用户义务
          4.1 您应妥善保管您的账号信息，对账号的所有行为负责。
          4.2 您不得利用认证服务从事任何违法违规活动。
          
          五、服务变更与终止
          5.1 我们有权根据业务需要变更或终止认证服务，如有变更将提前通知您。
          5.2 如您违反本协议条款，我们有权终止您的认证资格。
          
          六、其他条款
          6.1 本协议的最终解释权归本平台所有。
          6.2 如您对本协议有任何疑问，请联系客服。
        </text>
      </scroll-view>
      
      <view class="modal-actions">
        <button class="modal-btn" bindtap="hideAgreementModal">我知道了</button>
      </view>
    </view>
  </view>
</view>

<!--pages/real-name-auth/real-name-auth.wxml-->
<view class="auth-container">
  <!-- 顶部导航 -->
  <view class="auth-header">
    <view class="nav-back" bindtap="navigateBack">
      <image class="back-icon" src="/assets/icons/back-arrow.png"></image>
    </view>
    <text class="header-title">学生认证</text>
    <view class="nav-placeholder"></view>
  </view>
 
  <!-- 认证状态 -->
  <view class="status-card {{authStatus}}">
    <view class="status-icon">
      <image class="status-img" src="{{statusConfig.icon}}"></image>
    </view>
    <view class="status-content">
      <text class="status-title">{{statusConfig.title}}</text>
      <text class="status-desc">{{statusConfig.desc}}</text>
    </view>
    <view class="status-badge">{{statusConfig.badge}}</view>
  </view>
 
  <!-- 认证表单 -->
  <view class="auth-form" wx:if="{{authStatus === 'not_started' || authStatus === 'failed'}}">
    <!-- 个人信息 -->
    <view class="form-section">
      <view class="section-title">个人信息</view>
      
      <view class="form-item">
        <text class="item-label">真实姓名</text>
        <input 
          class="item-input" 
          type="text" 
          placeholder="请输入您的真实姓名"
          value="{{formData.realName}}"
          bindinput="onRealNameInput"
          maxlength="20"
        />
      </view>
      
      <view class="form-item">
        <text class="item-label">学校名称</text>
        <input 
          class="item-input" 
          type="text" 
          placeholder="请输入您的学校名称"
          value="{{formData.schoolName}}"
          bindinput="onSchoolNameInput"
          maxlength="50"
        />
      </view>
      
      <view class="form-item">
        <text class="item-label">学号</text>
        <input 
          class="item-input" 
          type="text" 
          placeholder="请输入您的学号"
          value="{{formData.studentId}}"
          bindinput="onStudentIdInput"
          maxlength="20"
        />
      </view>
    </view>
 
    <!-- 证件上传 -->
    <view class="form-section">
      <view class="section-title">学生证上传</view>
      <text class="section-desc">请上传清晰的学生证照片，需包含姓名、学号和学校信息</text>
      
      <view class="upload-single">
        <view 
          class="upload-box {{formData.studentCardImage ? 'has-image' : ''}}"
          bindtap="chooseStudentCardImage"
        >
          <image 
            wx:if="{{formData.studentCardImage}}" 
            class="uploaded-image" 
            src="{{formData.studentCardImage}}" 
            mode="aspectFill"
          ></image>
          <view class="upload-placeholder" wx:else>
            <image class="upload-icon" src="/assets/icons/camera.png"></image>
            <text class="upload-text">上传学生证</text>
            <text class="upload-hint">点击上传学生证照片</text>
          </view>
        </view>
      </view>
      
      <view class="upload-tips">
        <text class="tip-title">上传要求：</text>
        <text class="tip-item">• 照片清晰可辨认</text>
        <text class="tip-item">• 包含姓名、学号、学校信息</text>
        <text class="tip-item">• 照片大小不超过5MB</text>
        <text class="tip-item">• 支持JPG、PNG格式</text>
      </view>
    </view>
 
    <!-- 认证协议 -->
    <view class="agreement-section">
      <view class="agreement-item" bindtap="toggleAgreement">
        <view class="checkbox {{agreementChecked ? 'checked' : ''}}">
          <image 
            class="check-icon" 
            src="{{agreementChecked ? '/assets/icons/checkbox-checked.png' : '/assets/icons/checkbox-unchecked.png'}}"
          ></image>
        </view>
        <text class="agreement-text">我已阅读并同意</text>
        <text class="agreement-link" bindtap="viewAgreement">《学生认证服务协议》</text>
      </view>
    </view>
 
    <!-- 提交按钮 -->
    <view class="submit-section">
      <button 
        class="submit-btn {{canSubmit ? 'active' : ''}}" 
        bindtap="submitAuth"
        disabled="{{!canSubmit || isSubmitting}}"
      >
        {{isSubmitting ? '提交中...' : '提交认证'}}
      </button>
    </view>
  </view>
 
  <!-- 认证成功信息 -->
  <view class="success-info" wx:if="{{authStatus === 'success'}}">
    <view class="info-card">
      <view class="info-header">
        <text class="info-title">认证信息</text>
        <text class="info-time">认证时间: {{authInfo.authTime}}</text>
      </view>
      
      <view class="info-content">
        <view class="info-item">
          <text class="info-label">真实姓名</text>
          <text class="info-value">{{authInfo.realName}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">学校名称</text>
          <text class="info-value">{{authInfo.schoolName}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">学号</text>
          <text class="info-value">{{authInfo.studentId}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">认证状态</text>
          <view class="status-tag success">已认证</view>
        </view>
      </view>
    </view>
    
    <view class="action-buttons">
      <button class="action-btn secondary" bindtap="viewAgreement">查看协议</button>
      <button class="action-btn primary" bindtap="contactService">联系客服</button>
    </view>
  </view>
 
  <!-- 认证失败信息 -->
  <view class="failed-info" wx:if="{{authStatus === 'failed'}}">
    <view class="info-card">
      <view class="info-header">
        <text class="info-title">认证失败</text>
      </view>
      
      <view class="failed-reason">
        <text class="reason-title">失败原因:</text>
        <text class="reason-desc">{{authInfo.failReason}}</text>
      </view>
      
      <view class="suggestions">
        <text class="suggest-title">建议:</text>
        <view class="suggest-list">
          <text class="suggest-item">• 请确保姓名与学生证信息一致</text>
          <text class="suggest-item">• 请上传清晰、完整的学生证照片</text>
          <text class="suggest-item">• 确保学生证在有效期内</text>
          <text class="suggest-item">• 如问题持续，请联系客服</text>
        </view>
      </view>
    </view>
  </view>
 
  <!-- 认证审核中 -->
  <view class="reviewing-info" wx:if="{{authStatus === 'reviewing'}}">
    <view class="info-card">
      <view class="reviewing-content">
        <image class="reviewing-icon" src="/assets/icons/reviewing.png"></image>
        <text class="reviewing-title">认证审核中</text>
        <text class="reviewing-desc">我们将在1-3个工作日内完成审核</text>
        <text class="reviewing-time">提交时间: {{authInfo.submitTime}}</text>
      </view>
    </view>
    
    <view class="contact-tip">
      <text class="tip-text">如有疑问，请</text>
      <text class="tip-link" bindtap="contactService">联系客服</text>
    </view>
  </view>
 
  <!-- 协议弹窗 -->
  <view class="agreement-modal" wx:if="{{showAgreementModal}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">学生认证服务协议</text>
        <view class="close-btn" bindtap="hideAgreementModal">×</view>
      </view>
      <scroll-view class="modal-body" scroll-y>
        <view class="agreement-content">
          <view class="section">
            <text class="section-title">认证目的</text>
            <text class="section-text">学生认证旨在验证您的学生身份，以便为您提供学生专属服务和优惠。</text>
          </view>
          
          <view class="section">
            <text class="section-title">信息收集说明</text>
            <text class="section-text">为完成学生认证，我们需要收集以下信息：</text>
            <text class="section-text">1. 真实姓名：用于身份验证</text>
            <text class="section-text">2. 学校名称：确认您的在校身份</text>
            <text class="section-text">3. 学号：唯一身份标识</text>
            <text class="section-text">4. 学生证照片：证明学生身份的有效凭证</text>
          </view>
          
          <view class="section">
            <text class="section-title">信息使用承诺</text>
            <text class="section-text">1. 仅用于学生身份验证</text>
            <text class="section-text">2. 严格保密，不向第三方泄露</text>
            <text class="section-text">3. 认证完成后安全存储</text>
            <text class="section-text">4. 仅在必要时用于客服支持</text>
          </view>
          
          <view class="section">
            <text class="section-title">认证流程</text>
            <text class="section-text">1. 填写个人信息（姓名、学校、学号）</text>
            <text class="section-text">2. 上传清晰的学生证照片</text>
            <text class="section-text">3. 等待人工审核（1-3个工作日）</text>
            <text class="section-text">4. 认证通过后享受学生特权</text>
          </view>
          
          <view class="section">
            <text class="section-title">隐私保护</text>
            <text class="section-text">1. 采用加密技术保护传输安全</text>
            <text class="section-text">2. 严格限制信息访问权限</text>
            <text class="section-text">3. 定期进行安全审计</text>
          </view>
          
          <view class="section">
            <text class="section-title">违规处理</text>
            <text class="section-text">如发现提供虚假信息，我们将：</text>
            <text class="section-text">1. 取消学生认证资格</text>
            <text class="section-text">2. 限制账户相关功能</text>
            <text class="section-text">3. 保留追究法律责任的权利</text>
          </view>
          
          <view class="section">
            <text class="section-title">联系方式</text>
            <text class="section-text">认证问题请联系：student-auth@campus-life.com</text>
          </view>
        </view>
      </scroll-view>
      <view class="modal-footer">
        <button class="modal-btn" bindtap="hideAgreementModal">我知道了</button>
      </view>
    </view>
  </view>
</view>