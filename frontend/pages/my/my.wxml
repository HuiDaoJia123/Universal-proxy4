<!--pages/my/my.wxml-->
<view class="container">
  <!-- ç™»å½•åŒºåŸŸ -->
  <view class="login-section" wx:if="{{!isLoggedIn}}">
    <view class="login-bg"></view>
    <view class="login-content">
      <view class="login-header">
        <image class="login-logo" src="/images/default-avatar.png"></image>
        <text class="login-title">æ¬¢è¿æ¥åˆ°æ ¡å›­ç”Ÿæ´»åŠ©æ‰‹</text>
        <text class="login-subtitle">ç™»å½•äº«å—æ›´å¤šæœåŠ¡</text>
      </view>
      <view class="login-actions">
        <button class="login-btn" open-type="getPhoneNumber" bindgetphonenumber="getPhoneNumber">
          <text class="btn-icon">ğŸ“±</text>
          <text class="btn-text">å¾®ä¿¡ä¸€é”®ç™»å½•</text>
        </button>
      </view>
    </view>
  </view>
 
  <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="user-section" wx:else>
    <!-- ç”¨æˆ·å¤´éƒ¨ -->
    <view class="user-header">
      <view class="user-avatar-wrapper">
        <image class="user-avatar" src="{{userInfo.avatar_url || userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
        <view class="verified-badge" wx:if="{{userInfo.is_verified}}">
          <text class="verified-icon">âœ“</text>
        </view>
      </view>
      <view class="user-info">
        <view class="user-name-row">
          <text class="user-name">{{userInfo.nickname || userInfo.real_name || 'ç”¨æˆ·'}}</text>
          <view class="user-level" wx:if="{{userInfo.credit_score >= 100}}">
            <text class="level-text">ä¿¡ç”¨ä¼˜è‰¯</text>
          </view>
        </view>
        <text class="user-phone">{{userInfo.phone || 'æœªç»‘å®šæ‰‹æœºå·'}}</text>
      </view>
      <view class="edit-btn" bindtap="editProfile">
        <image class="edit-icon" src="/images/icon-edit.png"></image>
      </view>
    </view>
 
    <!-- ç»Ÿè®¡æ•°æ® -->
    <view class="stats-card">
      <view class="stats-item">
        <text class="stats-value">{{stats.orderCount}}</text>
        <text class="stats-label">å…¨éƒ¨è®¢å•</text>
      </view>
      <view class="stats-divider"></view>
      <view class="stats-item">
        <text class="stats-value">Â¥{{wallet.balance}}</text>
        <text class="stats-label">è´¦æˆ·ä½™é¢</text>
      </view>
      <view class="stats-divider"></view>
      <view class="stats-item">
        <text class="stats-value">{{userInfo.credit_score || 100}}</text>
        <text class="stats-label">ä¿¡ç”¨åˆ†</text>
      </view>
    </view>
 
    <!-- åŠŸèƒ½èœå• -->
    <view class="menu-card">
      <block wx:for="{{menuList}}" wx:key="id">
        <view class="menu-item" data-item="{{item}}" bindtap="onMenuTap">
          <view class="menu-left">
            <image class="menu-icon" src="{{item.icon}}" mode="aspectFit"></image>
            <view class="menu-text-wrapper">
              <text class="menu-title">{{item.title}}</text>
              <text class="menu-subtitle">{{item.subtitle}}</text>
            </view>
          </view>
          <view class="menu-right">
            <view class="badge" wx:if="{{item.id === 1 && stats.orderCount > 0}}">
              <text class="badge-text">{{stats.orderCount}}</text>
            </view>
            <image class="menu-arrow" src="/images/arrow-right.png"></image>
          </view>
        </view>
      </block>
    </view>
 
    <!-- å®åè®¤è¯æç¤º -->
    <view class="verify-card" wx:if="{{!userInfo.is_verified}}" bindtap="navigateToVerify">
      <view class="verify-left">
        <image class="verify-icon" src="/images/icon-verify.png"></image>
        <view class="verify-info">
          <text class="verify-title">å®Œæˆå®åè®¤è¯</text>
          <text class="verify-desc">è®¤è¯åäº«å—æ›´å¤šæœåŠ¡ç‰¹æƒ</text>
        </view>
      </view>
      <view class="verify-btn">
        <text class="verify-btn-text">å»è®¤è¯</text>
      </view>
    </view>
 
    <!-- é€€å‡ºç™»å½• -->
    <view class="logout-card">
      <button class="logout-btn" bindtap="logout">é€€å‡ºç™»å½•</button>
    </view>
 
    <!-- å®¢æœå…¥å£ -->
    <view class="service-card" bindtap="contactService">
      <image class="service-icon" src="/images/customer-service-avatar.png"></image>
      <text class="service-text">è”ç³»å®¢æœ</text>
    </view>
  </view>
</view>